\section{Trigonalisierbarkeit}

\begin{definition}
	Man nennt $f$ \begriff{trigonalisierbar}, wenn $V$ eine Basis $B$ besitzt, für die $M_B(f)$ eine obere Dreiecksmatrix ist.
\end{definition}

\begin{example}
	Ist $f$ diagonalisierbar, so ist $f$ auch trigonalisierbar.
\end{example}

\begin{lemma}
	\proplbl{lemma_4_3}
	Ist $f$ trigonalisierbar, so zerfällt $\chi_f$ in Linearfaktoren.
\end{lemma}
\begin{proof}
	Klar aus \propref{beispiel_2_8} und \propref{satz_2_3}.
\end{proof}

\begin{definition}[invariant]
	Ein Untervektorraum $W\le V$ ist $f$-\begriff{invariant}, wenn $f(W)\le W$.
\end{definition}

\begin{remark}
	Ist $W$ ein $f$-invarianter Untervektorraum von $V$, so ist $f\vert_W\in \End_K(W)$.
\end{remark}

\begin{example}
	\proplbl{beispiel_4_6}
	\begin{enumerate}
		\item $V$ hat stets die $f$-invarianten Untervektorräume $W=\{0\}$ und $W=V$.
		\item Jeder Untervektorraum $W\le \Eig(f,\lambda)$ ist $f$-invariant.
		\item Ist $B=(x_1,...,x_n)$ eine Basis von $V$, für die $M_B(f)$ eine obere Dreiecksmatrix ist, so sind alle Untervektorräume $W_i=\Span_K(x_1,...,x_i)$ $f$-invariant.
		\item Sei $V=W\oplus U$, $B_1=(x_1,...,x_r)$ Basis von $W$, $B_2(x_{r+1},...,x_n)$ Basis von $U$ und $B=(x_1,...,x_n)$. Ist $W$ $f$-invariant, so ist 
		\begin{align}
			M_B(f)=\begin{pmatrix}M_{B_1}(f\vert_W)&*\\0&*\end{pmatrix}\notag
		\end{align}
		Sind $W$ und $U$ $f$-invariant, so ist 
		\begin{align}
			M_B(f)=\begin{pmatrix}M_{B_1}(f\vert_W)&0\\0&M_{B_2}(f\vert_U)\end{pmatrix}\notag
		\end{align}
	\end{enumerate}
\end{example}

\begin{lemma}
	Ist $W\subset V$ ein $f$-invarianter Untervektorraum, so gilt $\chi_{f\vert_W}\mid \chi_f$. Hat $W$ ein lineares Komplement $U$, dass auch $f$-invariant ist, so $\chi_f=\chi_{f\vert_W}\cdot \chi_{f\vert_U}$.
\end{lemma}
\begin{proof}
	Ergänze eine Basis $B_0=(x_1,...,x_r)$ von $W$ zu einer Basis $B=(x_1,...,x_n)$ von $V$. Sei $A=M_B(f)$, $A_0=M_{B_0}(f\vert_W)$. Dann ist 
	\begin{align}
		A=\begin{pmatrix}A_0&*\\0&C\end{pmatrix}\quad C\in\Mat_{n-r}(K)\notag
	\end{align}
	folglich $\chi_f=\chi_A=\chi_{A_0}\cdot \chi_C$, insbesondere $\chi_{f\vert_W}\mid\chi_f$.\\
	Ist auch $U=\Span_K(x_{r+1},...,x_n)$ $f$-invariant, so ist 
	\begin{align}
		A=\begin{pmatrix}A_0&0\\0&C\end{pmatrix}\notag
	\end{align}
	und folglich $\chi_f=\chi_A=\chi_{A_0}\cdot\chi_C=\chi_{f\vert_W}\cdot\chi_{f\vert_U}$.
\end{proof}

\begin{theorem}[Trigonalisierungssatz]
	Genau dann ist $f$ trigonalisierbar, wenn $\chi_f$ in Linearfaktoren zerfällt.
\end{theorem}
\begin{proof}
	$(\Rightarrow)$: \propref{lemma_4_3}\\
	$(\Leftarrow)$: Induktion nach $n=\dim_K(V)$. \\
	\emph{$n=1$}: trivial \\
	\emph{$n-1\to n$}: Nach Annahme ist $\chi_f(t)=\prod_{i=1}^n (t-\lambda_i)$ mit $\lambda_1,...,\lambda_n\in K$. Sei $x_1$ ein Eigenvektor zum Eigenwert $\lambda_1$. Dann ist $V_1=K\cdot x_1$ ein $f$-invarianter Untervektorraum. Ergänze $B_1=(x_1)$ zu einer Basis $B=(x_1,...,x_n)$ von $V$ und setze $B_2=(x_2,...,x_n)$, $V_2=\Span_K(B_2)$.
	\begin{align}
		\Rightarrow M_B(f)&=\begin{pmatrix}\lambda_1&*\\0&A_2\end{pmatrix}\quad A_2\in\Mat_{n-1}(K)\notag\\
		\chi_f(t)&=\chi_{\lambda_1\mathbbm{1}_1}\cdot \chi_{A_2}=(t-\lambda_1)\cdot\chi_{A_2}(t)\notag \\
		\overset{\propref{lemma_3_7}}{\Rightarrow} \chi_{A_2}(t)&=\prod_{i=2}^n(t-\lambda_i)\notag
	\end{align}
	Seien $\pi_1,\pi_2\in\End_K(V)$ gegeben durch $M_B(\pi_1)=\diag(1,0,...,0)$ und $M_B(\pi_2)=\diag(0,1,...,1)$. Dann ist $\pi_1+\pi_2=\id_V$ und $f_i=\pi_1\circ f$ ist $f=\id_V\circ f=f_1+f_2$ und $f_2\vert_{V_2}\in\End_K(V_2)$. Nach Induktionshypothese ist $f_2\vert_{V_2}$ trigonalisierbar, da $M_B(f_2\vert_{V_2})=A_2$, also $\chi_{f_2\vert_{V_2}}=\chi_{A_2}$. Dies bedeutet, es gibt also eine Basis $B'_2=(x'_2,...,x'_n)$ von $V_2$, für die $M_{B'_2}(f_2\vert_{V_2})$ eine obere Dreiecksmatrix ist. Somit ist für $B'=(x_1,x'_2,...,x'_n)$ auch 
	\begin{align}
		M_{B'}(f)&=M_{B'}(f_1)+M_{B'}(f_2)\notag \\
		&= \begin{pmatrix}\lambda_1&*\\0&0\end{pmatrix} + \begin{pmatrix}0&0\\0&M_{B'_2}(f_2\vert_{V_2})\end{pmatrix}\notag
	\end{align}
	eine obere Dreiecksmatrix.
\end{proof}

\begin{conclusion}
	Ist $K$ algebraisch abgeschlossen, so ist jedes $f\in\End_K(V)$ trigonalisierbar.
\end{conclusion}
\begin{proof}
	Ist $K$ algebraisch abgeschlossen, so zerfällt nach \propref{1_6_14} jedes Polynom über $K$ in Linearfaktoren, insbesondere also $\chi_f$.
\end{proof}

\begin{conclusion}
	Ist $V$ ein endlichdimensionaler $\comp$-Vektorraum, so ist jedes $f\in\End_\comp(V)$ trigonalisierbar.
\end{conclusion}
\begin{proof}
	Nach dem Fundamentalsatz der Algebra \propref{1_6_16} ist $\comp$ algebraisch abgeschlossen.
\end{proof}