\section{Die \person{Jordan}-Normalform}

\begin{definition}[Hauptraum]
	Der \begriff{Hauptraum} von $f$ zum Eigenwert $\lambda$ der Vielfachheit $r=\mu_a(f,\lambda)$ ist
	\begin{align}
		\Hau(f,\lambda)=\Ker\Big( (f-\lambda\id_V)^r\Big) \notag
	\end{align}
\end{definition}

\begin{lemma}
	\proplbl{lemma_7_2}
	$\Hau(f,\lambda)$ ist ein $f$-invarianter Untervektorraum der Dimension $\dim_K(\Hau(f,\lambda))= \mu_a(f,\lambda)$, auf dem $f-\lambda\id_V$ nilpotent ist und $\chi_{f\vert_{\Hau(f,\lambda)}}= (t-\lambda)^{\mu_a(f,\lambda)}$
\end{lemma}
\begin{proof}
	$f$ kommutiert sowohl mit $f$ als auch mit $\id_V$, somit auch mit $(f-\lambda\id_V)^r$. Die $f$-Invarianz von $U=\Hau(f,\lambda)$ folgt aus \propref{lemma_6_3}. Nach \propref{folgerung_6_9} ist $\dim_K(U)=\mu_a(f-\lambda\id_V,0)$ und da $\chi_f(t)=\chi_{f-\lambda\id_V}(t-\lambda)$ ist $\mu_a(f,\lambda)=\mu(\chi_f,\lambda)= \mu_a(f-\lambda\id_V,0)$. Da $f-\lambda\id_V\vert_U$ nilpotent ist $\chi_{f-\lambda\id_V\vert_U}(t)= t^r$, somit $\chi_{f\vert_U}(t)=(t-\lambda)^r$.
\end{proof}

\begin{proposition}[Hauptraumzerlegung]
	\proplbl{satz_7_3}
	Ist $\chi_f(t)=\prod_{i=1}^m (t-\lambda_i)^{r_i}$ mit $\lambda_1,...,\lambda_m\in K$ paarweise verschieden und $r_1,...,r_m\in\natur$, so ist $V=\bigoplus_{i=1}^m V_i$ mit $V_i=\Hau(f,\lambda_i)$ eine Zerlegung in $f$-invariante Untervektorräume und für jedes $i$ ist $\chi_{f\vert_{V_i}}(t)=(t-\lambda_i)^{r_i}$.
\end{proposition}
\begin{proof}
	Induktion nach $m$.\\
	\emph{$m=1$}: $r_1=n\overset{\propref{lemma_7_2}}{\Rightarrow} V=V_1$.\\
	\emph{$m-1\to m$}: Nach \propref{satz_6_4} ist $V=V_1\oplus W_1$ mit $W_1=\Image((f-\lambda_i\id_V)^r)$ eine Zerlegung in $f$-invariante Untervektorräume mit $\dim_K(V_1)=r_1$, $\dim_K(W_1)=n-r_1$. Somit ist $\chi_f=\chi_{f\vert_{V_1}}\cdot \chi_{f\vert_{W_1}}$ und $\chi_{f\vert_{V_1}}\overset{\propref{lemma_7_2}}{=}(t-\lambda_1)^{r_1}$ also $\chi_{f\vert_{W_1}}=\prod_{i=2}^m (t-\lambda_i)^{r_i}$. Nach I.H. ist also $W_1=\bigoplus_{i=2}^m \Hau(f\vert_{W_1},\lambda_i)$. Es ist für $i\ge 2$ $\Hau(f\vert_{W_1},\lambda_i)\subseteq\Hau(f,\lambda_i)=V_i$ und da $\dim_K(\Hau(f\vert_{W_1},\lambda_i))=r_i=\dim_K(\Hau(f,\lambda_i))$ gilt Gleichheit. Damit ist
	\begin{align}
		V&=V_1\oplus W_1 \notag\\
		&=V_1\oplus\bigoplus_{i=2}^m\Hau(f\vert_{W_1},\lambda_i)\notag \\
		&= V_1\oplus\bigoplus_{i=2}^m V_i \notag\\
		&= \bigoplus_{i=1}^m V_i\notag
	\end{align}
\end{proof}

\begin{example}
	$f=f_A$
	\begin{align}
		A=\begin{pmatrix}1&3&\; \\ \;&1&4 \\ \;&\; & 2\end{pmatrix}\in\Mat_3(\real)\notag
	\end{align}
	$\chi_A(t)=(t-1)^2(t-2)$
	$\Rightarrow \real^3=\underbrace{\Hau(f,1)}_{\dim = 2}\oplus\underbrace{\Hau(f,2)}_{\dim = 1}$ \\
	$\Hau(f,1)=\Ker((f-\id)^2)=L((A-\mathbbm{1})^2,0)$ \\
	$\Hau(f,2)=\Ker(f-2\id)=\Eig(f,2)=L(A-2\mathbbm{1},0)$ \\
	\begin{align}
		A-\mathbbm{1}&=\begin{henrysmatrix}0&3&\; \\ \; & -1&4 \\ \;&\;&0\end{henrysmatrix}, (A-\mathbbm{1})^2=\begin{henrysmatrix}0&\;&12 \\ \;&0&4 \\ \;&\;&1\end{henrysmatrix}&\Rightarrow \Hau(f,1)=\real e_1+\real e_2\notag \\
		A-2\mathbbm{1}&=\begin{henrysmatrix}-1&3&\; \\ \; & -1&4 \\ \;&\;&0\end{henrysmatrix}&\Rightarrow\Hau(f,2)=\real\begin{henrysmatrix}12\\4\\1\end{henrysmatrix}\notag
	\end{align}
	Mit $B=\left( \begin{henrysmatrix}1\\0\\0\end{henrysmatrix}, \begin{henrysmatrix}0\\1\\0\end{henrysmatrix}, \begin{henrysmatrix}12\\4\\1\end{henrysmatrix}\right) $ ist
	\begin{align}
		M_B(f)=\begin{pmatrix}\begin{pmatrix}1&3\\\; & 1\end{pmatrix}&\; \\ \; & 2\end{pmatrix}\notag
	\end{align} 
\end{example}

\begin{theorem}[\person{Jordan}-Normalform]
	Sei $f\in\End_K(V)$ ein Endomorphismus, dessen charakteristisches Polynom $\chi_f$ in Linearfaktoren zerfällt. Dann gibt es $r\in\natur$, $\mu_1,...,\mu_r\in K$ und $k_1,...,k_r\in \natur$ mit $\sum_{i=1}^r k_i=\dim_K(V)$ und eine Basis $B$ von $V$ mit
	\begin{align}
		M_B(f)=\diag(J_{k_1}(\mu_1),...,J_{k_r}(\mu_r))\notag
	\end{align} 
	Die Paare $(\mu_1,k_1),...,(\mu_r,k_r)$ heißen die \begriff{\person{Jordan}-Invarianten} von $f$ und sind bis auf Reihenfolge eindeutig bestimmt.
\end{theorem}
\begin{proof}
	Schreibe $\chi_f(t)=\prod_{i=1}^m (t-\lambda_i)^{r_i}$ mit $\lambda_1,...,\lambda_m\in K$ paarweise verschieden, $r_i\in\natur$. Sei $V_i=\Hau(f,\lambda_i)$. Nach \propref{satz_7_3} ist $V=\bigoplus_{i=1}^m V_i$ eine Zerlegung in $f$-invariante Untervektorräume. Für jedes $i$ wenden wir \propref{satz_6_13} auf $(f-\lambda_i\id_V)\vert_{V_i}$ an und erhalten eine Basis $B_i$ von $V_i$ und $k_{i,1}\ge ...\ge k_{i,s_i}$ mit 
	\begin{align}
		M_B((f-\lambda_i\id)\vert_{V_i})=\diag(J_{k_{i,1}},...,J_{k_{i,s_i}})\notag
	\end{align}
	Es folgt $M_{B_i}(f\vert_{V_i})=M_{B_i}(\lambda_i\id_{V_i})+M_{B_i}((f-\lambda_i\id_V)\vert_{V_i})$. Ist nun $B$ die Vereinigung der $B_i$, so hat $M_B(f)$ die gewünschte Form. Die Eindeutigkeit der \person{Jordan}-Invarianten folgt aus der Eindeutigkeit der $k_{i,j}$ in \propref{lemma_6_3}.
\end{proof}

\begin{remark}
	Ist $K$ algebraisch abgeschlossen, so haben wir nun eine (bis auf Permutationen) eindeutige Normalform für Endomorphismen $f\in\End_K(V)$ gefunden. Aus ihr lassen sich viele Eigenschaften des Endomorphismus leicht ablesen.
\end{remark}

\begin{conclusion}
	\proplbl{folgerung_7_7}
	Sei $f\in\End_K(V)$ trigonalisierbar mit $\chi_f(t)=\prod_{i=1}^m (t-\lambda_i)^{\mu_a(f,\lambda_i)}$, $P_f(t)=\prod_{i=1}^m (t-\lambda_i)^{d_i}$ und \person{Jordan}-Invarianten $(\mu_1,k_1),...,(\mu_r,k_r)$. Mit $J_i=\{j\mid \mu_j=\lambda_i\}$ ist dann 
	\begin{align}
		\mu_g(f,\lambda_i)&= \vert J_i \vert \notag \\
		\mu_a(f,\lambda_i) &= \sum_{j\in J_i} k_j\notag \\
		d_i&= \max\{k_j\mid j\in J_i\}\notag
	\end{align}
\end{conclusion}
\begin{proof}
	\begin{itemize}
		\item $\mu_a$: klar, da $\chi_f(t)=\prod_{j=1}^r (t-\mu_j)^{k_j}=\prod_{i=1}^m (t-\lambda_i)^{\mu_a(f,\lambda_i)}$
		\item $\mu_g$: lese Basis von $\Eig(f,\lambda_i)$ aus \person{Jordan}-NF: Jeder Block $J_{k_j}(\lambda_i)$ liefert ein Element der Basis.
		\item $d_i$: folgt, da $J_{k_j}$ nilpotent von Nilpotenzklasse $k_j$ ist (\propref{lemma_6_12}).
	\end{itemize}
\end{proof}

\begin{conclusion}
	Genau dann ist $f$ diagonalisierbar, wenn 
	\begin{align}
		\chi_f(t)&=\prod_{i=1}^m (t-\lambda_i)^{r_i}\quad \lambda_1,...,\lambda_m\in K\text{ paarweise verscheiden und} \notag \\
		P_f(t) &= \prod_{i=1}^m (t-\lambda_i)\notag
	\end{align}
\end{conclusion}
\begin{proof}
	Genau dann ist $f$ diagonalisierbar, wenn $f$ trigonalisierbar ist und die \person{Jordan}-NF die Diagonalmatrix ist (Eindeutigkeit der JNF), also $k_j=1$ für alle $j$. Nach \propref{folgerung_7_7} ist dies äquivalent dazu, dass $d_i=1$ für alle $i$, also $P_f=\prod_{i=1}^m (t-\lambda_i)$.
\end{proof}

\begin{remark}
	Wieder definiert man die \person{Jordan}-Invarianten, etc. von einer Matrix $A\in\Mat_n(K)$ als die \person{Jordan}-Invarianten von $f_A\in\End_K(K^n)$.
\end{remark}

\begin{conclusion}
	Seien $A,B\in\Mat_n(K)$ trigonalisierbar. Genau dann ist $A\sim B$, wenn $A$ und $B$ die gleichen \person{Jordan}-Invarianten haben.
\end{conclusion}
\begin{proof}
	Existenz und Eindeutigkeit der \person{Jordan}-Normalform.
\end{proof}