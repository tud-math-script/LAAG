\section{Diagonalisierbarkeit}

\begin{definition}[diagonalisierbar]
	Man nennt $f$ \begriff{diagonalisierbar}, wenn $V$ eine Basis $B$ besitzt, für die $M_B(f)$ eine Diagonalmatrix ist.
\end{definition}

\begin{lemma}
	\proplbl{lemma_diag_summe_eig}
	Genau dann ist $f$ diagonalisierbar, wenn
	\begin{align}
		V=\sum\limits_{\lambda\in K} \Eig(f,\lambda) \notag
	\end{align}.
\end{lemma}
\begin{proof}
	$(\Rightarrow)$: Ist $B$ eine Basis aus Eigenvektoren von $f$ (vgl. \propref{satz_diagonal_ev}), so ist $B\le \bigcup\limits_{\lambda\in K}\Eig(f,\lambda)$, also $V=\Span_K(\bigcup\limits_{\lambda\in K}\Eig(f, \lambda))=\sum_{\lambda\in K}\Eig(f,\lambda)$. \\
	$(\Leftarrow)$: Ist $V=\sum_{\lambda\in K}\Eig(f,\lambda)$, so gibt es $\lambda_1,...,\lambda_n \in K$ mit $V=\sum_{i=1}^r \Eig(f,\lambda_i)$. Wir wählen Basen $B_i$ von $\Eig(f,\lambda_i)$. Dann ist $\bigcup\limits_{i=1}^r B_i$ ein endliches Erzeugendensystem von $V$, enthält also eine Basis von $V$ (\propref{2_3_6}). Diese besteht aus Eigenvektoren von $f$.
\end{proof}

\begin{proposition}
	Ist $\dim_K(V)=n$, so hat $f$ höchstens $n$ Eigenwerte. Hat $f$ genau $n$ Eigenwerte, so ist $f$ diagonalisierbar.
\end{proposition}
\begin{proof}
	Ist $\lambda$ ein Eigenwert von $f$, so ist $\dim_K(\Eig(f,\lambda))\ge 1$. Sind also $\lambda_1,...,\lambda_n$ paarweise verschiedene Eigenwerte von $f$, so ist
	\begin{align}
		n=\dim_K(V)&\ge \dim_K\left( \sum\limits_{i=1}^m \Eig(f,\lambda_i)\right) \notag \\
		&\overset{\propref{satz_eig_direkte_summe}}{=} \dim_K\left( \bigoplus_{i=0}^{m} \Eig(f,\lambda_i)\right) \notag \\
		&= \sum\limits_{i=1}^m \dim_K(\Eig(f,\lambda_i)) \notag \\
		&\ge m \notag
	\end{align}
	Ist zudem $m=n$, so muss 
	\begin{align}
		\dim_K(V) &= \dim_K(\sum\limits_{i=1}^m \Eig(f,\lambda_i))\text{ sein, also }\notag \\
		V&= \sum\limits_{i=1}^m \Eig(f,\lambda_i) \notag
	\end{align}
	Nach \propref{lemma_diag_summe_eig} ist $f$ genau dann diagonalisierbar.
\end{proof}

\begin{definition}[$a$ teilt $b$]
	Sei $R$ ein kommutativer Ring mit seien $a,b\in R$. Man sagt, $a$ \begriff{teilt} $b$ (in Zeichen $a\mid b$), wenn es $x\in R$ mit $b=ax$ gibt.
\end{definition}

\begin{definition}[Vielfachheit]
	Für $0\neq P\in K[t]$ und $\lambda\in K$ nennt man $\mu(P,\lambda)=\max\{r\in \natur_{>0}\mid (t-r)^r\mid P\}$ die \begriff{Vielfachheit} der Nullstelle $\lambda$ von $P$.
\end{definition}

\begin{lemma}
	\proplbl{lemma_3_6}
	Genau dann ist $\mu(P,\lambda)\ge 1$, wenn $\lambda$ eine Nullstelle von $P$ ist.
\end{lemma}
\begin{proof}
	$(\Rightarrow)$: $(t-\lambda)\mid P\Rightarrow P(t)=(t-\lambda)\cdot Q(t)$ mit $Q(t)\in K[t]\Rightarrow P(\lambda)=0\cdot Q(\lambda)=0$. \\
	$(\Leftarrow)$: $P(\lambda)=0\overset{\propref{1_6_9}}{=}(t-\lambda)\mid P(t)\Rightarrow \mu(P,\lambda)\ge 1$.
\end{proof}

\begin{lemma}
	\proplbl{lemma_3_7}
	Ist $P(t)=(t-\lambda)^r\cdot Q(t)$ mit $Q(t)\in K[t]$ und $Q(\lambda)\neq 0$, so ist $\mu(P,\lambda)=r$
\end{lemma}
\begin{proof}
	Offensichtlich ist $\mu(P,\lambda)\ge r$. Wäre $\mu(P,\lambda)\ge r+l$, so $(t-\lambda)^{r+l}\mid P(t)$ also $(t-\lambda)^r\cdot Q(t)=(t-\lambda)^{r^+l}\cdot R(t)$ mit $R(t)\in K[t]$, folglich $(t-\lambda)\mid Q(t)$, insbesondere $Q(\lambda)=0$. \\
	(Denn wir dürfen kürzen: $R$ ist nullteilerfrei, genau so wie $K[t]$). \\
	$(t-\lambda)^r(Q(t)-(t-\lambda)R(t))=0\Rightarrow Q(t)=(t-\lambda)R(t)$.
\end{proof}

\begin{lemma}
	\proplbl{lemma_3_8}
	Sind $P,Q,R\in K[t]$ mit $PQ=PR$, und ist $P\neq 0$, so ist $Q=R$.
\end{lemma}
\begin{proof}
	$PQ=PR\Rightarrow P(Q-R)=0\xRightarrow{K[t]\text{ nullteilerfrei}} Q-R=0$, das heißt $Q=R$.
\end{proof}

\begin{lemma}
	\proplbl{lemma_3_9}
	Es ist $\sum_{\lambda\in K} \mu(P,\lambda)\le \deg(P)$, mit Gleichheit genau dann, wenn $P$ in Linearfaktoren zerfällt.
\end{lemma}
\begin{proof}
	Schreibe $P(t)=\prod_{\lambda\in K}(t-\lambda)^{r_\lambda}\cdot Q(t)$, wobei $Q(t)\in K[t]$ keine Nullstellen mehr besitzt. Nach \propref{lemma_3_7} ist $\mu(P,\lambda)=r_\lambda$ für alle $\lambda$ und somit $\deg(P)=\sum_{\lambda\in K} r_\lambda+\deg(Q)\ge \sum_{\lambda\in K} \mu(P,\lambda)$ mit Gleichheit genau dann,wenn $\deg(Q)=0$, also $Q=c\in K$, d.h. genau dann, wenn $P(t)=c\cdot \prod_{\lambda\in K} (t-\lambda)^{r_\lambda}$.
\end{proof}

\begin{lemma}
	\proplbl{lemma_3_10}
	Für $\lambda\in K$ ist
	\begin{align}
		\dim_K(\Eig(f,\lambda))\ge \mu(x_f,\lambda)\notag
	\end{align}
\end{lemma}
\begin{proof}
	Ergänze eine Basis $B$ von $\Eig(f,\lambda)$ zu einer Basis $B$ von $V$. Dann ist 
	\begin{align}
		A=M_B(f)=\begin{pmatrix}\lambda\mathbbm{1}_s&*\\0&A'\end{pmatrix}\notag
	\end{align}
	mit einer Matrix $A'\in \Mat_{n-s}(K)$, also $\chi_f(t)=\chi_A(t)\overset{\propref{beispiel_2_8}}{=}\chi_{\lambda\mathbbm{1}}\cdot\chi_{A'}(t)=(t- \lambda)^s\cdot \chi_{A'}(t)$ und somit $\dim_K(\Eig(f,\lambda))=s\le \mu(x_f,\lambda)$.
\end{proof}

\begin{proposition}[Diagonalisierungssatz]
	Genau dann ist $f$ diagonalisierbar, wenn $\chi_f$ in Linearfaktoren zerfällt und $\dim_K(\Eig(f,\lambda))=\mu(\chi_f,\lambda)$ für alle $\lambda\in K$.
\end{proposition}
\begin{proof}
	Es gilt
	\begin{align}
		\dim_K(\sum\limits_{\lambda\in K}\Eig(f,\lambda))&\overset{\propref{satz_eig_direkte_summe}}{=} \dim_K(\bigoplus\limits_{\lambda\in K}\Eig(f,\lambda)) \notag \\
		&\overset{\text{\propref{2_4_12}}}{=}\sum\limits_{\lambda\in K}\dim_K(\Eig(f,\lambda)) \notag \\
		&\overset{\propref{lemma_3_10}}{\le}\sum\limits_{\lambda\in K}\mu(\chi_f,\lambda) \\
		&\le \deg(\chi_f) \\
		&= n \notag
	\end{align}
	Nach \propref{lemma_diag_summe_eig} ist $f$ genau dann diagonalisierbar, wenn $\dim_K(\sum_{\lambda\in K}\Eig(f,\lambda))=n$, also wenn bei (1) und (2) Gleichheit herrscht. Gleichheit bei (1) bedeutet $\dim_K(\Eig(f,\lambda))=\mu(\chi_f,\lambda)$ für alle $\lambda\in K$, und Gleichheit bei (2) bedeutet nach \propref{lemma_3_9}, dass $\chi_f$ in Linearfaktoren zerfällt.
\end{proof}

\begin{definition}[algebraische und geometrische Vielfachheit]
	Man nennt $\mu_a(f,\lambda)=\mu(\chi_f,\lambda)$ die \begriff[Vielfachheit!]{algebraische Vielfachheit} und $\mu_g(f,\lambda)=\dim_K(\Eig(f,\lambda))$ die  \begriff[Vielfachheit!]{geometrische Vielfachheit} des Eigenwertes $\lambda$ von $f$.
\end{definition}

\begin{remark}
	Wieder nennt man $A\in\Mat_n(K)$ diagonalisierbar, wenn $f_A\in\End_K(K^n)$ diagonalisierbar ist, also wenn $A\sim D$ für eine Diagonalmatrix $D$.
\end{remark}